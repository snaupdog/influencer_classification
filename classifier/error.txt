
During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/snau/code/capstone/final/classifier/run_classification.py", line 44, in <module>
    model = load_model(
        "influencer_profiler_best.keras",
        custom_objects={"PostAttentionLayer": PostAttentionLayer},
    )
  File "/home/snau/code/capstone/final/myenv/lib/python3.13/site-packages/keras/src/saving/saving_api.py", line 189, in load_model
    return saving_lib.load_model(
           ~~~~~~~~~~~~~~~~~~~~~^
        filepath,
        ^^^^^^^^^
    ...<2 lines>...
        safe_mode=safe_mode,
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/snau/code/capstone/final/myenv/lib/python3.13/site-packages/keras/src/saving/saving_lib.py", line 365, in load_model
    return _load_model_from_fileobj(
        f, custom_objects, compile, safe_mode
    )
  File "/home/snau/code/capstone/final/myenv/lib/python3.13/site-packages/keras/src/saving/saving_lib.py", line 442, in _load_model_from_fileobj
    model = _model_from_config(
        config_json, custom_objects, compile, safe_mode
    )
  File "/home/snau/code/capstone/final/myenv/lib/python3.13/site-packages/keras/src/saving/saving_lib.py", line 431, in _model_from_config
    model = deserialize_keras_object(
        config_dict, custom_objects, safe_mode=safe_mode
    )
  File "/home/snau/code/capstone/final/myenv/lib/python3.13/site-packages/keras/src/saving/serialization_lib.py", line 735, in deserialize_keras_object
    raise TypeError(
    ...<6 lines>...
    )
TypeError: <class 'keras.src.models.functional.Functional'> could not be deserialized properly. Please ensure that components that are Python object instances (layers, models, etc.) returned by `get_config()` are explicitly deserialized in the model's `from_config()` method.

config={'module': 'keras.src.models.functional', 'class_name': 'Functional', 'config': {}, 'registered_name': 'Functional', 'build_config': {'input_shape': None}, 'compile_config': {'optimizer': {'module': 'keras.optimizers', 'class_name': 'Adam', 'config': {'name': 'adam', 'learning_rate': 4.999999873689376e-05, 'weight_decay': None, 'clipnorm': None, 'global_clipnorm': None, 'clipvalue': None, 'use_ema': False, 'ema_momentum': 0.99, 'ema_overwrite_frequency': None, 'loss_scale_factor': None, 'gradient_accumulation_steps': None, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}, 'registered_name': None}, 'loss': 'categorical_crossentropy', 'loss_weights': None, 'metrics': ['accuracy'], 'weighted_metrics': None, 'run_eagerly': False, 'steps_per_execution': 1, 'jit_compile': True}}.

Exception encountered: <class '__main__.PostAttentionLayer'> could not be deserialized properly. Please ensure that components that are Python object instances (layers, models, etc.) returned by `get_config()` are explicitly deserialized in the model's `from_config()` method.

config={'module': None, 'class_name': 'PostAttentionLayer', 'config': {'name': 'post_attention', 'trainable': True, 'dtype': {'module': 'keras', 'class_name': 'DTypePolicy', 'config': {'name': 'float32'}, 'registered_name': None, 'shared_object_id': 135389549523664}, 'hidden_dim': 512}, 'registered_name': 'PostAttentionLayer', 'build_config': {'input_shape': [None, 512]}, 'name': 'post_attention', 'inbound_nodes': [{'args': [{'class_name': '__keras_tensor__', 'config': {'shape': [None, 512], 'dtype': 'float32', 'keras_history': ['dropout', 0, 0]}}], 'kwargs': {}}]}.

Exception encountered: Error when deserializing class 'PostAttentionLayer' using config={'name': 'post_attention', 'trainable': True, 'dtype': 'float32', 'hidden_dim': 512}.

Exception encountered: name 'Dense' is not defined
(myenv) snau:~/code/capstone/final/classifier ls
error.txt  influencer_profiler_best.keras  influencer_profiler_final.keras  run_classification.py
(myenv) snau:~/code/capstone/final/classifier cat error.txt
(myenv) snau:~/code/capstone/final/classifier py run_classification.py > error.txt
2025-11-22 20:03:02.141158: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-22 20:03:02.242793: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-22 20:03:04.304389: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-22 20:03:04.957314: E external/local_xla/xla/stream_executor/cuda/cuda_platform.cc:51] failed call to cuInit: INTERNAL: CUDA error: Failed call to cuInit: UNKNOWN ERROR (303)
Traceback (most recent call last):
  File "/home/snau/code/capstone/final/myenv/lib/python3.13/site-packages/keras/src/ops/operation.py", line 317, in from_config
    return cls(**config)
  File "/home/snau/code/capstone/final/classifier/run_classification.py", line 10, in __init__
    self.fc = Dense(hidden_dim)
              ^^^^^
NameError: name 'Dense' is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/snau/code/capstone/final/myenv/lib/python3.13/site-packages/keras/src/saving/serialization_lib.py", line 733, in deserialize_keras_object
    instance = cls.from_config(inner_config)
  File "/home/snau/code/capstone/final/myenv/lib/python3.13/site-packages/keras/src/ops/operation.py", line 319, in from_config
    raise TypeError(
    ...<2 lines>...
    )
TypeError: Error when deserializing class 'PostAttentionLayer' using config={'name': 'post_attention', 'trainable': True, 'dtype': 'float32', 'hidden_dim': 512}.

Exception encountered: name 'Dense' is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/snau/code/capstone/final/myenv/lib/python3.13/site-packages/keras/src/saving/serialization_lib.py", line 733, in deserialize_keras_object
    instance = cls.from_config(inner_config)
  File "/home/snau/code/capstone/final/myenv/lib/python3.13/site-packages/keras/src/models/model.py", line 694, in from_config
    return functional_from_config(
        cls, config, custom_objects=custom_objects
    )
  File "/home/snau/code/capstone/final/myenv/lib/python3.13/site-packages/keras/src/models/functional.py", line 558, in functional_from_config
    process_layer(layer_data)
    ~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/snau/code/capstone/final/myenv/lib/python3.13/site-packages/keras/src/models/functional.py", line 525, in process_layer
    layer = serialization_lib.deserialize_keras_object(
        layer_data, custom_objects=custom_objects
    )
  File "/home/snau/code/capstone/final/myenv/lib/python3.13/site-packages/keras/src/saving/serialization_lib.py", line 735, in deserialize_keras_object
    raise TypeError(
    ...<6 lines>...
    )
TypeError: <class '__main__.PostAttentionLayer'> could not be deserialized properly. Please ensure that components that are Python object instances (layers, models, etc.) returned by `get_config()` are explicitly deserialized in the model's `from_config()` method.

config={'module': None, 'class_name': 'PostAttentionLayer', 'config': {'name': 'post_attention', 'trainable': True, 'dtype': {'module': 'keras', 'class_name': 'DTypePolicy', 'config': {'name': 'float32'}, 'registered_name': None, 'shared_object_id': 135389549523664}, 'hidden_dim': 512}, 'registered_name': 'PostAttentionLayer', 'build_config': {'input_shape': [None, 512]}, 'name': 'post_attention', 'inbound_nodes': [{'args': [{'class_name': '__keras_tensor__', 'config': {'shape': [None, 512], 'dtype': 'float32', 'keras_history': ['dropout', 0, 0]}}], 'kwargs': {}}]}.

Exception encountered: Error when deserializing class 'PostAttentionLayer' using config={'name': 'post_attention', 'trainable': True, 'dtype': 'float32', 'hidden_dim': 512}.

Exception encountered: name 'Dense' is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/snau/code/capstone/final/classifier/run_classification.py", line 44, in <module>
    model = load_model(
        "influencer_profiler_best.keras",
        custom_objects={"PostAttentionLayer": PostAttentionLayer},
    )
  File "/home/snau/code/capstone/final/myenv/lib/python3.13/site-packages/keras/src/saving/saving_api.py", line 189, in load_model
    return saving_lib.load_model(
           ~~~~~~~~~~~~~~~~~~~~~^
        filepath,
        ^^^^^^^^^
    ...<2 lines>...
        safe_mode=safe_mode,
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/snau/code/capstone/final/myenv/lib/python3.13/site-packages/keras/src/saving/saving_lib.py", line 365, in load_model
    return _load_model_from_fileobj(
        f, custom_objects, compile, safe_mode
    )
  File "/home/snau/code/capstone/final/myenv/lib/python3.13/site-packages/keras/src/saving/saving_lib.py", line 442, in _load_model_from_fileobj
    model = _model_from_config(
        config_json, custom_objects, compile, safe_mode
    )
  File "/home/snau/code/capstone/final/myenv/lib/python3.13/site-packages/keras/src/saving/saving_lib.py", line 431, in _model_from_config
    model = deserialize_keras_object(
        config_dict, custom_objects, safe_mode=safe_mode
    )
  File "/home/snau/code/capstone/final/myenv/lib/python3.13/site-packages/keras/src/saving/serialization_lib.py", line 735, in deserialize_keras_object
    raise TypeError(
    ...<6 lines>...
    )
TypeError: <class 'keras.src.models.functional.Functional'> could not be deserialized properly. Please ensure that components that are Python object instances (layers, models, etc.) returned by `get_config()` are explicitly deserialized in the model's `from_config()` method.

config={'module': 'keras.src.models.functional', 'class_name': 'Functional', 'config': {}, 'registered_name': 'Functional', 'build_config': {'input_shape': None}, 'compile_config': {'optimizer': {'module': 'keras.optimizers', 'class_name': 'Adam', 'config': {'name': 'adam', 'learning_rate': 4.999999873689376e-05, 'weight_decay': None, 'clipnorm': None, 'global_clipnorm': None, 'clipvalue': None, 'use_ema': False, 'ema_momentum': 0.99, 'ema_overwrite_frequency': None, 'loss_scale_factor': None, 'gradient_accumulation_steps': None, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}, 'registered_name': None}, 'loss': 'categorical_crossentropy', 'loss_weights': None, 'metrics': ['accuracy'], 'weighted_metrics': None, 'run_eagerly': False, 'steps_per_execution': 1, 'jit_compile': True}}.

Exception encountered: <class '__main__.PostAttentionLayer'> could not be deserialized properly. Please ensure that components that are Python object instances (layers, models, etc.) returned by `get_config()` are explicitly deserialized in the model's `from_config()` method.

config={'module': None, 'class_name': 'PostAttentionLayer', 'config': {'name': 'post_attention', 'trainable': True, 'dtype': {'module': 'keras', 'class_name': 'DTypePolicy', 'config': {'name': 'float32'}, 'registered_name': None, 'shared_object_id': 135389549523664}, 'hidden_dim': 512}, 'registered_name': 'PostAttentionLayer', 'build_config': {'input_shape': [None, 512]}, 'name': 'post_attention', 'inbound_nodes': [{'args': [{'class_name': '__keras_tensor__', 'config': {'shape': [None, 512], 'dtype': 'float32', 'keras_history': ['dropout', 0, 0]}}], 'kwargs': {}}]}.

Exception encountered: Error when deserializing class 'PostAttentionLayer' using config={'name': 'post_attention', 'trainable': True, 'dtype': 'float32', 'hidden_dim': 512}.

Exception encountered: name 'Dense' is not defined
